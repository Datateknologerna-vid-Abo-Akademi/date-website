# Set django DEVELOP setting (set to False in prod)
export DEVELOP=True

# Set env file to use
export ENV_FILE=example.env

set -a
source $ENV_FILE
set +a

if [ "$DEVELOP" = "False" ]; then
    COMPOSE_FILES="-f docker-compose.yml -f docker-compose.prod.yml"
    OPTIONS="--build"
else
    COMPOSE_FILES="-f docker-compose.yml"
    OPTIONS="--build -w --remove-orphans"
fi

# =============================================================== #
#
# DO NOT EDIT THESE!
# (unless you know what you are doing)
#
# =============================================================== #

alias date-migrate="docker-compose $COMPOSE_FILES run --rm web python manage.py migrate --noinput"
alias date-makemigrations="docker-compose $COMPOSE_FILES run --rm web python manage.py makemigrations"
alias date-collectstatic="docker-compose $COMPOSE_FILES run --rm web python manage.py collectstatic"
alias date-stop="docker-compose $COMPOSE_FILES down"
alias date-start="date-pull; date-stop; docker-compose $COMPOSE_FILES up $OPTIONS"
alias date-start-detached="date-pull; date-stop; docker-compose $COMPOSE_FILES up -d $OPTIONS"
# alias date-start="date-stop; sleep 5; docker-compose up -d --build"
alias date-createsuperuser="docker-compose $COMPOSE_FILES run --rm web python manage.py createsuperuser"
alias date-pull="docker-compose $COMPOSE_FILES pull"
date-test() {
    docker-compose run -e TEST=1 --rm web python manage.py test "$@";
}